<!doctype html>
<html>
  <head>
    <script src="/socket.io/socket.io.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script>
    (function($) {
      $(function() {
        var socket = io.connect('http://localhost'),
        login = $('#login'),
        game = $('#game'),
        user = { name: '', points: 0 };
        $('form', login)
          .on({
            submit: function(e) {
              e.preventDefault();
              var name = $('input', login).val();
              if (name.length) {
                socket.emit('join', { user: name });
              }
              return false;
            }
          });
        socket.on('let in', function(data) {
          if (data.hasOwnProperty('user')) {
            var game_form = $('form', game);
            user.name = data.user;
            login.hide();
            $('h1', game).text(user.name + ' - ' + user.points + ' points');
            game.show();
            game_form
              .on({
                submit: function(e) {
                  e.preventDefault();
                  var input = $('input', this);
                  socket.emit('answer', { answer: input.val() });
                  $(this).hide();
                  input.remove();
                  return false;
                }
              });
            socket.on('question', function(data) {
              if (data.hasOwnProperty('question')) {
                $('.question span', game).text(data.question);
                game_form.append('<input type="text" />');
              }
            });
          }
        });
      });
    }(jQuery));
    </script>
  </head>
  <body>
    <div id="login">
      <form action="/" method="post">
        <input type="text" name="login" />
        <button>Join</button>
      </form>
    </div>
    <div id="game" style="display: none;">
      <h1></h1>
      <p class="question">Question: <span></span></p>
      <form action="/" method="post" style="display: none;">
        <button>Answer</button>
      </form>
    </div>
  </body>
</html>
